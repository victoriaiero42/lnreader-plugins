var e=this&&this.__awaiter||function(e,a,t,l){return new(t||(t=Promise))((function(n,r){function i(e){try{u(l.next(e))}catch(e){r(e)}}function o(e){try{u(l.throw(e))}catch(e){r(e)}}function u(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(i,o)}u((l=l.apply(e,a||[])).next())}))},a=this&&this.__generator||function(e,a){var t,l,n,r,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,o[0]&&(i=0)),i;)try{if(t=1,l&&(n=2&o[0]?l.return:o[0]?l.throw||((n=l.return)&&n.call(l),0):l.next)&&!(n=n.call(l,o[1])).done)return n;switch(l=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,l=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=a.call(e,i)}catch(e){o=[6,e],l=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("cheerio"),l=require("@libs/fetch"),n=require("@libs/filterInputs"),r=function(){function r(){this.id="novelfire",this.name="Novel Fire",this.version="1.0.1",this.icon="src/en/novelfire/icon.png",this.site="https://novelfire.net/",this.filters={sort:{label:"Sort Results By",value:"all-time-rank",options:[{label:"All Time Rank",value:"all-time-rank"},{label:"Monthly Rank",value:"monthly-rank"},{label:"Daily Rank",value:"daily-rank"},{label:"Bookmark Count (Most)",value:"bookmark"},{label:"Review Count (Most)",value:"review"},{label:"Last Updated (Newest)",value:"date"},{label:"Title (A>Z)",value:"abc"},{label:"Title (Z>A)",value:"cba"}],type:n.FilterTypes.Picker},status:{label:"Translation Status",value:"-1",options:[{label:"All",value:"-1"},{label:"Completed",value:"1"},{label:"Ongoing",value:"0"}],type:n.FilterTypes.Picker},genre_operator:{label:"Genres (And/Or)",value:"and",options:[{label:"And",value:"and"},{label:"Or",value:"or"}],type:n.FilterTypes.Picker},genres:{label:"Genres",value:[],options:[{label:"Action",value:"3"},{label:"Adult",value:"28"},{label:"Adventure",value:"4"},{label:"Anime",value:"46"},{label:"Arts",value:"47"},{label:"Comedy",value:"5"},{label:"Drama",value:"24"},{label:"Eastern",value:"44"},{label:"Ecchi",value:"26"},{label:"Fan-fiction",value:"48"},{label:"Fantasy",value:"6"},{label:"Game",value:"19"},{label:"Gender Bender",value:"25"},{label:"Harem",value:"7"},{label:"Historical",value:"12"},{label:"Horror",value:"37"},{label:"Isekai",value:"49"},{label:"Josei",value:"2"},{label:"Lgbt+",value:"45"},{label:"Magic",value:"50"},{label:"Magical Realism",value:"51"},{label:"Manhua",value:"52"},{label:"Martial Arts",value:"15"},{label:"Mature",value:"8"},{label:"Mecha",value:"34"},{label:"Military",value:"53"},{label:"Modern Life",value:"54"},{label:"Movies",value:"55"},{label:"Mystery",value:"16"},{label:"Psychological",value:"9"},{label:"Realistic Fiction",value:"56"},{label:"Reincarnation",value:"43"},{label:"Romance",value:"1"},{label:"School Life",value:"21"},{label:"Sci-fi",value:"20"},{label:"Seinen",value:"10"},{label:"Shoujo",value:"38"},{label:"Shoujo Ai",value:"57"},{label:"Shounen",value:"17"},{label:"Shounen Ai",value:"39"},{label:"Slice of Life",value:"13"},{label:"Smut",value:"29"},{label:"Sports",value:"42"},{label:"Supernatural",value:"18"},{label:"System",value:"58"},{label:"Tragedy",value:"32"},{label:"Urban",value:"63"},{label:"Urban Life",value:"59"},{label:"Video Games",value:"60"},{label:"War",value:"61"},{label:"Wuxia",value:"31"},{label:"Xianxia",value:"23"},{label:"Xuanhuan",value:"22"},{label:"Yaoi",value:"14"},{label:"Yuri",value:"62"}],type:n.FilterTypes.CheckboxGroup},language:{label:"Language",value:[],options:[{label:"Chinese",value:"1"},{label:"Korean",value:"2"},{label:"Japanese",value:"3"},{label:"English",value:"4"}],type:n.FilterTypes.CheckboxGroup},rating_operator:{label:"Rating (Min/Max)",value:"min",options:[{label:"Min",value:"min"},{label:"Max",value:"max"}],type:n.FilterTypes.Picker},rating:{label:"Rating",value:"0",options:[{label:"All",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"}],type:n.FilterTypes.Picker},chapters:{label:"Chapters",value:"0",options:[{label:"All",value:"0"},{label:"<50",value:"1,49"},{label:"50-100",value:"50,100"},{label:"100-200",value:"100,200"},{label:"200-500",value:"200,500"},{label:"500-1000",value:"500,1000"},{label:">1000",value:"1001,1000000"}],type:n.FilterTypes.Picker}}}return r.prototype.popularNovels=function(n,r){return e(this,arguments,void 0,(function(e,n){var r,i,o,u,s,c,v,p,b,h,f=this,d=n.showLatestNovels,g=n.filters;return a(this,(function(a){switch(a.label){case 0:if(r=this.site+"search-adv",d)r+="?ctgcon=and&totalchapter=0&ratcon=min&rating=0&status=-1&sort=date&tagcon=and&page=".concat(e);else if(g){for(i=new URLSearchParams,o=0,u=g.language.value;o<u.length;o++)s=u[o],i.append("country_id[]",s);for(i.append("ctgcon",g.genre_operator.value),c=0,v=g.genres.value;c<v.length;c++)p=v[c],i.append("categories[]",p);i.append("totalchapter",g.chapters.value),i.append("ratcon",g.rating_operator.value),i.append("rating",g.rating.value),i.append("status",g.status.value),i.append("sort",g.sort.value),i.append("page",e.toString()),r+="?".concat(i.toString())}else r+="?ctgcon=and&totalchapter=0&ratcon=min&rating=0&status=-1&sort=all-time-rank&page=".concat(e);return[4,(0,l.fetchApi)(r)];case 1:return[4,a.sent().text()];case 2:return b=a.sent(),[2,(h=(0,t.load)(b))(".novel-item").map((function(e,a){var t=h(a).find(".novel-title > a").attr("title")||"No Title Found",l=h(a).find(".novel-cover > img").attr("data-src"),n=h(a).find(".novel-title > a").attr("href");return n?{name:t,cover:l,path:n.replace(f.site,"")}:null})).get().filter((function(e){return null!==e}))]}}))}))},r.prototype.parseChapters=function(n,r){return e(this,void 0,void 0,(function(){var i,o,u,s,c,v,p,b=this;return a(this,(function(h){switch(h.label){case 0:return i=Array.from({length:r},(function(e,a){return a+1})),o=[],u=function(r){return e(b,void 0,void 0,(function(){var e,i,o,u=this;return a(this,(function(a){switch(a.label){case 0:return e="".concat(this.site).concat(n,"/chapters?page=").concat(r),[4,(0,l.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return i=a.sent(),o=(0,t.load)(i),[2,o(".chapter-list li").map((function(e,a){var t=o(a).find("a").attr("title")||"No Title Found",l=o(a).find("a").attr("href");return l?{name:t,path:l.replace(u.site,"")}:null})).get().filter((function(e){return null!==e}))]}}))}))},[4,Promise.all(i.map(u))];case 1:for(s=h.sent(),c=0,v=s;c<v.length;c++)p=v[c],o.push.apply(o,p);return[2,0===o.length?[]:o]}}))}))},r.prototype.parseNovel=function(n){return e(this,void 0,void 0,(function(){var e,r,i,o,u,s,c;return a(this,(function(a){switch(a.label){case 0:return e=this.site+n,[4,(0,l.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return r=a.sent(),i=(0,t.load)(r),o={path:n,name:i(".novel-title").text()||"No Title Found",cover:i(".cover > img").attr("data-src"),genres:i(".categories .property-item").map((function(e,a){return i(a).text()})).toArray().join(","),summary:i(".summary .content .txt").html().replace(/<\/p>/g,"\n\n").replace(/<br\s*\/?>/gi,"\n").replace(/<[^>]+>/g,"").trim()||"No Summary Found",author:i(".author .property-item > span").text()||"No Author Found",status:i(".header-stats .ongoing").text()||i(".header-stats .completed").text()||"No Status Found"},u=i(".header-stats .icon-book-open").parent().text().trim(),s=Math.ceil(parseInt(u)/100),c=o,[4,this.parseChapters(n,s)];case 3:return c.chapters=a.sent(),[2,o]}}))}))},r.prototype.parseChapter=function(n){return e(this,void 0,void 0,(function(){var e,r,i;return a(this,(function(a){switch(a.label){case 0:return e=this.site+n,[4,(0,l.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return r=a.sent(),i=(0,t.load)(r),[".box-ads",".box-notification",/^nf/].forEach((function(e){e instanceof RegExp?i("*").filter((function(a,t){return e.test(i(t).prop("tagName").toLowerCase())})).remove():i(e).remove()})),[2,i("#content").html()]}}))}))},r.prototype.searchNovels=function(n,r){return e(this,void 0,void 0,(function(){var e,i,o,u=this;return a(this,(function(a){switch(a.label){case 0:return e="".concat(this.site,"search?keyword=").concat(n,"&page=").concat(r),[4,(0,l.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return i=a.sent(),[2,(o=(0,t.load)(i))(".novel-list.chapters .novel-item").map((function(e,a){var t=o(a).find("a").attr("title")||"No Title Found",l=o(a).find(".novel-cover > img").attr("src"),n=o(a).find("a").attr("href");return n?{name:t,cover:l,path:n.replace(u.site,"")}:null})).get().filter((function(e){return null!==e}))]}}))}))},r}();exports.default=new r;